<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WronAI Projects</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .repo-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .repo-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .language-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
        .filter-btn {
            transition: all 0.2s ease;
        }
        .filter-btn.active {
            background-color: #3b82f6;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-12">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-gray-800 mb-4">WronAI Projects</h1>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                Open-source AI and ML projects focused on edge computing, LLMs, and code quality tools.
                Built by the community, for the community.
            </p>
            <div class="mt-8 flex flex-wrap justify-center gap-4" id="filter-buttons">
                <button class="filter-btn px-4 py-2 rounded-full bg-gray-200 hover:bg-gray-300" data-filter="all">All</button>
                <!-- Language filters will be added dynamically -->
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="repos-container">
            <!-- Repository cards will be added dynamically -->
        </div>
    </div>

    <script>
        // Load repository data from JSON file
        let repos = [];
        
        // Fetch repository data
        async function loadRepos() {
            try {
                const response = await fetch('repos.json');
                const data = await response.json();
                return data.repositories;
            } catch (error) {
                console.error('Error loading repository data:', error);
                return [];
            }
        }

        ];

        // Language colors mapping
        const languageColors = {
            'Python': '#3572A5',
            'JavaScript': '#f1e05a',
            'TypeScript': '#2b7489',
            'Go': '#00ADD8',
            'Shell': '#89e051',
            'Documentation': '#555',
            'Other': '#6e5494'
        };

        // Initialize the page
        document.addEventListener('DOMContentLoaded', async () => {
            repos = await loadRepos();
            renderRepos();
            setupFilters();
        });

        // Render all repositories
        function renderRepos(filterLanguage = 'all') {
            const container = document.getElementById('repos-container');
            container.innerHTML = '';

            const filteredRepos = filterLanguage === 'all' 
                ? repos 
                : repos.filter(repo => repo.language === filterLanguage);

            filteredRepos.forEach(repo => {
                const card = createRepoCard(repo);
                container.appendChild(card);
            });
        }


        // Create a repository card element
        function createRepoCard(repo) {
            const card = document.createElement('div');
            card.className = 'repo-card bg-white rounded-lg shadow-md overflow-hidden border border-gray-200 dark:bg-gray-800 dark:border-gray-700';
            
            const color = languageColors[repo.language] || '#6e5494';
            const updated = formatDate(repo.updatedAt);
            const hasInstallCommand = repo.installCommand && repo.installCommand.trim() !== '';
            const pypiUrl = repo.pypi ? `https://pypi.org/project/${repo.pypi}/` : '';
            
            card.innerHTML = `
                <div class="p-6">
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="text-xl font-bold text-gray-800 dark:text-white truncate">${repo.name}</h3>
                        ${repo.isArchived ? '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-100">Archived</span>' : ''}
                    </div>
                    
                    <p class="text-gray-600 dark:text-gray-300 mb-4 h-12 line-clamp-2">${repo.description || 'No description provided'}</p>
                    
                    <div class="flex flex-wrap items-center text-sm text-gray-500 dark:text-gray-400 mb-4 gap-2">
                        <span class="flex items-center">
                            <span class="language-dot" style="background-color: ${color}"></span>
                            ${repo.language || 'Unknown'}
                        </span>
                        <span class="mx-1">â€¢</span>
                        <span>Updated ${updated}</span>
                    </div>
                    
                    <!-- Installation Commands -->
                    ${hasInstallCommand ? `
                    <div class="mb-4">
                        <div class="flex items-center text-sm text-gray-500 dark:text-gray-400 mb-1">
                            <i class="fas fa-terminal mr-2"></i>
                            <span>Install:</span>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-md p-2 mb-2">
                            <div class="flex items-center justify-between">
                                <code class="text-sm font-mono text-gray-800 dark:text-gray-200">${repo.installCommand}</code>
                                <button class="copy-btn ml-2 p-1 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200" 
                                        data-command="${repo.installCommand}">
                                    <i class="far fa-copy"></i>
                                </button>
                            </div>
                        </div>
                    </div>` : ''}
                    
                    <!-- Action Buttons -->
                    <div class="flex flex-wrap gap-2">
                        <a href="${repo.url}" target="_blank" rel="noopener noreferrer" 
                           class="inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors">
                            <i class="fab fa-github mr-2"></i> Code
                        </a>
                        
                        ${repo.website ? `
                        <a href="${repo.website}" target="_blank" rel="noopener noreferrer"
                           class="inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors">
                            <i class="fas fa-external-link-alt mr-2"></i> Website
                        </a>` : ''}
                        
                        ${pypiUrl ? `
                        <a href="${pypiUrl}" target="_blank" rel="noopener noreferrer"
                           class="inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors">
                            <i class="fab fa-python mr-2"></i> PyPI
                        </a>` : ''}
                        
                        <div class="relative group
                            <button class="copy-btn inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"
                                    data-command="${repo.cloneCommand}">
                            <i class="fas fa-clone mr-2"></i> Clone
                            </button>
                            <span class="copy-tooltip absolute z-10 invisible group-hover:visible bg-gray-900 text-white text-xs rounded py-1 px-2 -top-8 left-1/2 transform -translate-x-1/2">
                                Click to copy
                            </span>
                        </div>
                    </div>
                </div>
            `;
            
            // Add click handler for copy buttons
            card.querySelectorAll('.copy-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const command = btn.getAttribute('data-command');
                    navigator.clipboard.writeText(command).then(() => {
                        const originalText = btn.innerHTML;
                        btn.innerHTML = '<i class="fas fa-check mr-2"></i> Copied!';
                        btn.classList.add('bg-green-100', 'text-green-800', 'border-green-200');
                        setTimeout(() => {
                            btn.innerHTML = originalText;
                            btn.classList.remove('bg-green-100', 'text-green-800', 'border-green-200');
                        }, 2000);
                    });
                });
            });
            
            return card;
            
            return card;
        }

        // Set up filter buttons
        function setupFilters() {
            const filterContainer = document.getElementById('filter-buttons');
            const languages = [...new Set(repos.map(repo => repo.language))].sort();
            
            languages.forEach(lang => {
                const button = document.createElement('button');
                button.className = 'filter-btn px-4 py-2 rounded-full bg-gray-200 hover:bg-gray-300';
                button.textContent = lang;
                button.dataset.filter = lang;
                button.addEventListener('click', () => {
                    document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    renderRepos(lang);
                });
                filterContainer.appendChild(button);
            });

            // Add event listener to 'All' button
            const allButton = filterContainer.querySelector('[data-filter="all"]');
            allButton.addEventListener('click', () => {
                document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
                allButton.classList.add('active');
                renderRepos('all');
            });
        }

        // Format date to relative time
        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffInSeconds = Math.floor((now - date) / 1000);
            
            const intervals = {
                year: 31536000,
                month: 2592000,
                week: 604800,
                day: 86400,
                hour: 3600,
                minute: 60
            };
            
            for (const [unit, seconds] of Object.entries(intervals)) {
                const interval = Math.floor(diffInSeconds / seconds);
                if (interval >= 1) {
                    return `${interval} ${unit}${interval === 1 ? '' : 's'} ago`;
                }
            }
            
            return 'just now';
        }
    </script>
</body>
</html>
